# Set variables
$siteName = "YourSiteName"  # Replace with your actual site name
$certThumbprint = "YourCertThumbprint"  # Replace with the thumbprint of your new SSL certificate

# Get the site by name
$site = Get-WebSite -Name $siteName

# Get the certificate by thumbprint
$cert = Get-Item Cert:\LocalMachine\My\$certThumbprint

# Get the existing binding
$binding = $site.Bindings | Where-Object { $_.Protocol -eq "https" }

# Update the binding with the new certificate
$binding.AddSslCertificate($cert.GetCertHash(), "My")

# Commit the changes
$site | Set-WebSite -Force

Write-Host "SSL certificate updated for $siteName"


# Set variables
$siteName = "YourSiteName"  # Replace with your actual site name
$certThumbprint = "YourCertThumbprint"  # Replace with the thumbprint of your new SSL certificate

# Get the site by name
$site = Get-WebSite -Name $siteName

# Get the existing binding
$existingBinding = Get-WebBinding -Name $siteName -Port 443

# Remove the existing binding
Remove-WebBinding -Name $siteName -Port 443 -Protocol "https"

# Create a new binding with the updated certificate
New-WebBinding -Name $siteName -Port 443 -Protocol "https" -HostHeader $existingBinding.HostHeader -SslFlags 1  # Use SslFlags 1 for SNI SSL

# Set the SSL certificate for the new binding
Set-WebBinding -Name $siteName -Port 443 -PropertyName "CertificateHash" -Value $certThumbprint

Write-Host "SSL certificate updated for $siteName"



